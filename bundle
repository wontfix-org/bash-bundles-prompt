#!/usr/bin/env bash

BBPROMPT_HOSTCOLOR=${BBPROMPT_HOSTCOLOR:-"\$(bbprompt_hostcolor)"}
BBPROMPT_USER=${BBPROMPT_USER:-"\[\033[38;5;230m\]\u"}
BBPROMPT_HOST=${BBPROMPT_HOST:-"\[$BBPROMPT_HOSTCOLOR\]\\h"}
BBPROMPT_DIRECTORY=${BBPROMPT_DIRECTORY:-'\[\033[38;5;104m\]\W$(__git_ps1 " (%s)")'}
BBPROMPT_RETURN_CODE=${BBPROMPT_RETURN_CODE:-'\[$(bbprompt_return_code $return_code)\]'}
BBPROMPT_JOBS=${BBPROMPT_JOBS:-'$(jobs=$(jobs | wc -l ); [ $jobs -gt 0 ] && echo -n "[$jobs] ")'}
BBPROMPT_PRE_COMMAND=${BBPROMPT_PRE_COMMAND:-"export return_code=\$?"}
BBPROMPT_POST_COMMAND=${BBPROMPT_POST_COMMAND:-"history -a"}
BBPROMPT_RETURN_CODE_COLOR=${BBPROMPT_RETURN_CODE_COLOR:-'\033[0;0m\033[38;5;124m'}

BBPROMPT_COLOR_L_BLUE=${BBPROMPT_COLOR_L_BLUE:-'\033[38;5;33m'}
BBPROMPT_COLOR_D_BLUE=${BBPROMPT_COLOR_D_BLUE:-'\033[38;5;21m'}
BBPROMPT_COLOR_M_PURP=${BBPROMPT_COLOR_M_PURP:-'\033[38;5;69m'}
BBPROMPT_COLOR_L_YELL=${BBPROMPT_COLOR_L_YELL:-'\033[38;5;229m'}
BBPROMPT_COLOR_M_YELL=${BBPROMPT_COLOR_M_YELL:-'\033[38;5;227m'}
BBPROMPT_COLOR_M_YELL=${BBPROMPT_COLOR_M_YELL:-'\033[38;5;227m'}
BBPROMPT_COLOR_M_GREN=${BBPROMPT_COLOR_M_GREN:-'\033[38;5;35m'}
BBPROMPT_COLOR_M_GREY=${BBPROMPT_COLOR_M_GREY:-'\033[38;5;245m'}
BBPROMPT_COLOR_M_ORNG=${BBPROMPT_COLOR_M_ORNG:-'\033[38;5;208m'}
BBPROMPT_COLOR_L_PINK=${BBPROMPT_COLOR_L_PINK:-'\033[38;5;206m'}
BBPROMPT_COLOR_M_TEAL=${BBPROMPT_COLOR_M_TEAL:-'\033[38;5;38m'}
BBPROMPT_COLOR_M_BRWN=${BBPROMPT_COLOR_M_BRWN:-'\033[38;5;130m'}
BBPROMPT_COLOR_L_WHTE=${BBPROMPT_COLOR_L_WHTE:-'\033[38;5;230m'}
BBPROMPT_COLOR_END=${BBPROMPT_COLOR_END:-'\033[0;0m'}

NC='\[\e[0m\]'

bbprompt_return_code() {
    if [ "$1" != "0" ] ; then
        echo -ne $BBPROMPT_RETURN_CODE_COLOR$1' '
    fi
    return $1
}

export PS1=${BBPROMPT_PS1:-"${BBPROMPT_USER}@${BBPROMPT_HOST} ${BBPROMPT_DIRECTORY} ${BBPROMPT_JOBS}$NC$ "}

# display user@host:/path in title, append to bash_history on every command
case $TERM in
	xterm*|rxvt|Eterm|eterm|rxvt-unicode)
		PROMPT_COMMAND='echo -ne "\033]0;${USER}@${HOSTNAME%%.*}:${PWD/$HOME/~}\007"'
		;;
	screen)
		PROMPT_COMMAND='echo -ne "\033_${USER}@${HOSTNAME%%.*}:${PWD/$HOME/~}\033\\" ; echo -ne "\033k${USER}@${HOSTNAME%%.*}:${PWD/$HOME/~}\033\\"'
	;;
esac
PROMPT_COMMAND="$BBPROMPT_PRE_COMMAND ; $PROMPT_COMMAND ; $BBPROMPT_POST_COMMAND"

